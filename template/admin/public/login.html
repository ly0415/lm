<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>711家居网 | 登录页面</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="{$STATIC_URL}/admin/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="{$STATIC_URL}/admin/dist/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="{$STATIC_URL}/plugin/iCheck/square/blue.css">

    <link rel="stylesheet" href="{$STATIC_URL}/plugin/dialog/jquery-confirm.min.css">
    <link rel="stylesheet" href="{$STATIC_URL}/admin/dist/css/main.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body class="hold-transition login-page">
<div class="login-box">
    <div class="login-logo">
        <a href="#"><b>711家居网总平台 </b></a>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <p class="login-box-msg">登录窗口</p>

        <form>
            <div class="form-group has-feedback">
                <input type="text" class="form-control" name="account_name" placeholder="请输入账号">
                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" class="form-control" name="password" placeholder="请输入密码">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="text" class="form-control" name="validate" placeholder="请输入验证码" style="width: 200px; float: left;" >
                <a href="javascript:void(0)" class="validate-img"><img src="?app=default&act=createCode" width="102" height="38" onclick="javascript:this.src='?app=default&act=createCode&ts='+Math.random()" style="float: left;" /></a>
            </div>
            <div class="row">
                <div class="col-xs-4" style="margin-left:120px; float: left; margin-top: 20px;">
                    <button type="button" class="btn btn-primary btn-block btn-flat"  id="B_login" >登 录</button>
                </div>
            </div>
        </form>
    </div>
</div>>
</body>

<!-- /.login-box -->

<!-- jQuery 2.2.3 -->
<script src="{$STATIC_URL}/plugin/jQuery/jquery-2.2.3.min.js"></script>
<!-- Bootstrap 3.3.6 -->
<!--<script src="{$STATIC_URL}/admin/js/bootstrap.js"></script>-->
<!-- iCheck -->
<!--<script src="{$STATIC_URL}/plugin/iCheck/icheck.min.js"></script>-->
<script src="{$STATIC_URL}/plugin/iCheck/icheck.min.js"></script>
<script src="{$STATIC_URL}/admin/dist/js/common.js"></script>
<script src="{$STATIC_URL}/plugin/dialog/jquery-confirm.min.js"></script>
<script type="text/javascript" src="{$STATIC_URL}/front/plus/layer/layer.js"></script>
<script>
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' // optional
        });
        document.onkeydown = function(event){
            e = event ? event :(window.event ? window.event : null);
            if(e.keyCode==13){
                var button = document.getElementById('B_login');
                button.focus();
                button.onclick();
            }
        };
    });
</script>
   {literal}
<script type="text/javascript">
  $('#B_login').click(function(){
    var url = "?app=account&act=doLogin";
    var account_name = $('input[name=account_name]').val();
    var password     = $('input[name=password]').val();
    var validate     = $('input[name=validate]').val();
      $.ajax({
          url: url,
          type: 'post',
          data:{account_name:account_name,password:password,validate:validate},
          async: false, //默认为true 异步
          error: function() {
              alert('error');
          },
          success: function(data) {
             var data = eval("("+data+")");
             console.log(data);
             if(data.status ==1){
                $.dialog({
                    content: '<div class="text-center">登录成功！</div>',
                    title: false, // hides the title.
                    closeIcon: false, // hides the close icon.
                    columnClass: 'xsmall'
                });
             setTimeout(
                function(){
                     window.location = '?app=default&act=index';
             },500);
             }else if(data.status == 0){
                var d= $.dialog({
                     content: '<div class="text-center">'+data.message+'</div>',
                     title: false, // hides the title.
                     closeIcon: false, // hides the close icon.
                     columnClass: 'xsmall',
                     onOpen: function(){
                      setTimeout(function(){
                        d.close();
                         }, 1000);
                    }
                 });
            }else if(data.status ==2) {
                 layer.confirm('账号已被登录，继续登录吗？', {
                btn: ['是','否'] //按钮
                }, function(){
                    $.ajax({
                        url: "admin.php?app=account&act=goOnLogin",
                        data: {'flag':data.info.flag,'userName': data.info.userName,'userId': data.info.userId, 'url': data.info.url},
                        type: "POST",
                        dataType: "json",
                        success: function(res) {
//                            console.log(res);
//                            return ;
//                                                console.log(res);
//                                                return ;
////                                                layer.alert(res.message, {
////                                                    icon: 1,
////                                                    btn:false,
////                                                    title:false,
////                                                    closeBtn: 0,
////                                                    time:3000,
////                                                    skin:'alt-layer'
////                                                });
                            window.location =res.info.url;
                        }
                  })
                 }, function(){
            });
        }
     }
      });

  });

</script>
 {/literal}
</html>
