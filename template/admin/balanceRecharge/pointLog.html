<!DOCTYPE html>
<html>
<head>
    {include file="public/header.html"}
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
    {include file="public/title.html"}
    <!-- Left side column. contains the logo and sidebar -->
    {include file="public/menu.html"}

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        {include file="public/headtab.html"}
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                &nbsp;&nbsp;{$language1->recharge_log}
            </h1>
            <ol class="breadcrumb">
                <li><a href="admin.php?app=default&act=index"><i class="fa fa-dashboard"></i> {$language1->index}</a></li>
                <li class="active">{$language1->member_manage}</li>
                <li class="active">{$language1->recharge_log}</li>
            </ol>

        </section>

        <!-- Main content -->
        <section class="content">
            <!-- /.row -->
            <div class="row">
                <div class="col-xs-12">
                    <div class="box box-primary">
                        <div class="box-header">
                            <form class="form-inline col-sm-10 col-md-11 no-padding">
                                <input type='hidden' name='app' value='balanceRecharge'>
                                <input type='hidden' name='act' value='index'>
                                <input type="hidden" name = "delAll" value="dele">
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">{$language1->user_name}：</small>
                                    <input type="text" class="form-control" name='username' value='{$username}'>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">{$language2->contact_type}：</small>
                                    <input type="text" class="form-control" name='phone' value='{$phone}'>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">{$language1->recharge_type}：</small>
                                    <select class="form-control select-type" name="type" id="class" onchange="getCateld(this, 2)">
                                        <option value="0">{$language2->please_select}</option>
                                        <option value="1" {if $type == 1} selected {/if}>{$language1->recharge}</option>
                                        <option value="3" {if $type == 3} selected {/if}>{$language1->register_gift}</option>
                                        <option value="4" {if $type == 4} selected {/if}>{$language1->offline_payment}</option>
                                        <option value="5" {if $type == 5} selected {/if}>{$language1->recharge_code}</option>
                                        <option value="7" {if $type == 7} selected {/if}>{$language1->system_process}</option>
                                    </select>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <!--<small class="control-label">{$language1->recharge_status}：</small>-->
                                    <select class="form-control j_select select-status" name="status"  id="status">
                                        <option value="0">{$language2->please_select}</option>
                                        {if $type ==1}
                                        <option value="1" {if $status == 1} selected {/if}>{$language2->to_paid}</option>
                                        <option value="2" {if $status == 2} selected {/if}>{$language2->paid}</option>
                                        <option value="3" {if $status == 3} selected {/if}>{$language1->payment_fail}</option>
                                        {elseif $type ==4}
                                        <option value="1" {if $status == 1} selected {/if}>{$language2->pending_review}</option>
                                        <option value="2" {if $status == 2} selected {/if}>{$language2->success_review}</option>
                                        <option value="3" {if $status == 3} selected {/if}>{$language2->audit_fail}</option>
                                        {elseif $type ==3}
                                        <option value="3" {if $status == 4} selected {/if}>{$language1->given}</option>
                                        {elseif $type ==6}
                                        <option value="4" {if $status == 4} selected {/if}>{$language1->refunded}</option>
                                        {/if}
                                    </select>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">{$language1->recharge_source}：</small>
                                    <select class="form-control select-source" name="source">
                                        <option value="0">{$language2->please_select}</option>
                                        <option value="1" {if $source == 1} selected {/if}>{$language1->accounts}</option>
                                        <option value="2" {if $source == 2} selected {/if}>{$language1->applets}</option>
                                        <option value="3" {if $source == 3} selected {/if}>{$language1->pc}</option>
                                    </select>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">{$language2->operate_time}：</small>
                                    <input type="text" class="form-control" id="datepicker" name="start_time" value="{$startTime}" readonly>
                                    --
                                    <input type="text" class="form-control" id="datepicker2" name="end_time" value="{$endTime}" readonly>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <button type="submit" class="btn btn-default btn-sm">
                                        {$language2->search} <i class="fa fa-search"></i>
                                    </button>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <button class="btn btn-default btn-sm" id="export">
                                        导出
                                    </button>
                                </div >
                            </form>
                        </div>
                        <div class="new-table-responsive">
                            <div class="box-body table-responsive no-padding">
                                <table class="table table-hover">
                                    <thead>
                                    <tr>
                                        <!--<th><input type="checkbox" name="" id="all"/></th>-->
                                        <th>ID</th>
                                        <th>{$language1->user_name}</th>
                                        <th>{$language2->contact_type}</th>
                                        <th>{$language1->recharge_amount}</th>
                                        <th>{$language1->amount_before}</th>
                                        <th>{$language1->amount_after}</th>
                                        <th>{$language1->recharge_desc}</th>
                                        <th>{$language1->recharge_type}</th>
                                        <th>{$language1->recharge_status}</th>
                                        <th>{$language1->resource}</th>
                                        <th>{$language2->operate_time}</th>
                                    </tr>
                                    </thead>

                                    {foreach from=$info item=item}
                                    <tr>
                                        <td>{$item.sort}</td>
                                        <td>{$item.username}</td>
                                        <td>{$item.phone}</td>
                                        <td style="color:#00a900;font-size:16px">&nbsp;{$item.recharge_amount}</td>
                                        <td style="color:#00a900;font-size:16px">&nbsp;{$item.amount_before}</td>
                                        <td style="color:#00a900;font-size:16px">&nbsp;{$item.amount_after}</td>
                                        <td>{$item.recharge_rule}</td>
                                        <td>{$item.recharge_type}</td>
                                        <td><span style="color:{if $item.status == 1 || $item.status == 3}red{else}#00a900{/if}">{$item.recharge_status}</span></td>
                                        <td>{$item.source}</td>
                                        <td>{$item.add_time}</td>
                                    </tr>
                                    {/foreach}

                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                        <div class="box-footer clearfix">
                            {$page_html}
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- /.content -->
    </div>
    {include file="public/footer.html"}
</div>
{literal}
<script  type="text/javascript" >
    function  getCateld(obj, level) {
        var parent_id = parseInt(obj.value);
        if (level == 2) {
            var id = 'status';
            if (parent_id == 1) {
                var html = '<option value="0">请选择</option><option value="1">待支付</option><option value="2">已支付</option><option value="3">支付失败</option>';
                $('#' + id).html(html);
            } else if (parent_id == 4) {
                var html = '<option value="0">请选择</option><option value="1">待审核</option><option value="2">审核成功</option><option value="3">审核不通过</option>';
                $('#' + id).html(html);
            } else if (parent_id == 3) {
                var html = '<option value="4">已赠送</option>';
                $('#' + id).html(html);
            } else if (parent_id == 6) {
                var html = '<option value="4">已退款</option>';
                $('#' + id).html(html);
            } else{
                var html = '<option value="0">暂无</option>';
                $('#' + id).html(html);
            }
        }
    }
</script>
{/literal}
<script type="text/javascript">
    $(document).ready(function () {
        //Date picker
        $('#datepicker').datepicker({
            autoclose: true,
            clearBtn: true,
            format: 'yyyy-mm-dd'

        });
        $('#datepicker2').datepicker({
            autoclose: true,
            clearBtn: true,
            format: 'yyyy-mm-dd'

        });

        // 导出
        $('#export').click(function () {
            var username = $('input[name=username]').val();
            var phone = $('input[name=phone]').val();
            var type = $('.select-type option:selected').val();
            var status = $('.select-status option:selected').val();
            var source = $('.select-source option:selected').val();
            var start_time = $('input[name=start_time]').val();
            var end_time = $('input[name=end_time]').val();
            // alert(is_use);return;
            location.href = '?app=balanceRecharge&act=index&export=1&username=' + username + '&phone=' + phone + '&start_time=' + start_time + '&end_time=' + end_time + '&type=' + type + '&status=' + status + '&source=' + source;
            return false;
        });
    });
</script>
</body>
</html>
