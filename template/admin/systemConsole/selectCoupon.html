<div class="height">
    <div class="new-table-responsive">
        <div class="box-body table-responsive no-padding ">
            <div class="box-header">
                <div class="form-inline col-sm-10 col-md-11 no-padding">
                    <div class="form-group form-group-sm form-mar">
                        <small class="control-label">{$language1->area_countroy}：</small>
                        <select class="form-control w160 j_select j-area" id="area_id" name="area_id">
                            <option value="0">--{$language1->select_country}--</option>
                            {$areaOption}
                        </select>
                    </div>
                    <div class="form-group form-group-sm form-mar">
                        <small class="control-label">{$language2->regional_store}：</small>
                        <select class="form-control w160 j_select j-store" id="store_id" name="store_id">
                            <option value="0">--{$language1->select_shop}--</option>
                            {$storeOption}
                        </select>
                    </div>
                    <div class="form-group form-group-sm form-mar">
                        <button type="button" class="btn btn-default btn-sm" id="submit1">
                            {$language2->search} <i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
            <input type="hidden"  name="totalpage"  value="{$totalpage}" >
            <table class="table tc-box">
                <thead>
                <tr>
                    <th></th>
                    <th>{$language2->serial_number}</th>
                    <!--<th>抵扣券的序号</th>-->
                    <th>{$language1->deduction_coupon_name}</th>
                    <th>{$language1->satisfy_amount}</th>
                    <th>{$language1->reduction_amount}</th>
                    <th>{$language1->usage_day}</th>
                    <th>{$language1->valid_date}</th>
                </tr>
                </thead>
                <tbody  id="content" >
                {foreach from=$data item=item key=k}
                <tr>
                    <td style="text-align: center"><input class="radio-name" style="cursor: pointer" type="radio" name="radio" data-name="{$item.coupon_name}" data-id="{$item.id}" {if $rebate_id[0]['rebate_id'] == $item.id}checked{/if}></td>
                    <td style="text-align: center">{$k+1}</td>
                    <!--<td>{$item.id}</td>-->
                    <td style="text-align: center">{$item.coupon_name}</td>
                    <td style="text-align: center">{$item.money}</td>
                    <td style="text-align: center">{$item.discount}</td>
                    <td style="text-align: center">{$item.day_times}</td>
                    <td style="text-align: center">{$item.limit_times}</td>
                </tr>
                {/foreach}
                </tbody>
            </table>
            <div class="page-box">
                <ul id="page" class="pagination" >

                </ul>
            </div>
        </div>
    </div>
</div>
            <input type="hidden" name = "language1_select_shop" value="{$language1->select_shop}"/>
            
            <input type="hidden" name = "language1_index" value="{$language1->index}"/>
            <input type="hidden" name = "language1_previous_page" value="{$language1->previous_page}"/>
            <input type="hidden" name = "language1_next_page" value="{$language1->next_page}"/>
            <input type="hidden" name = "language1_last_page" value="{$language1->last_page}"/>
{literal}
<script  type="text/javascript" >

    $('#area_id').change(function(){
        var language1_select_shop=$('input[name=language1_select_shop]').val();
        var area_id = $('#area_id').val();
        var url = "admin.php?app=distributor&act=getAreaToStoreAjax&area_id="+area_id;

        $.ajax({
            type: "GET",
            dataType: "json",
            url: url,
            success: function(obj) {
                // console.log(obj);
                if (obj.status == 1) {
                    var option = "<option value='0'>--" + language1_select_shop + "--</option>"
                    option += obj.info;
                    $('#store_id').html(option);

                } else {
                    option = "<option value='0'>--" + language1_select_shop + "--</option>";
                    $('#store_id').html(option);
                }

            }

        });

    });
    /*分页*/
    $(function() {
        var language1_index=$('input[name=language1_index]').val();
        var language1_previous_page=$('input[name=language1_previous_page]').val();
        var language1_next_page=$('input[name=language1_next_page]').val();
        var language1_last_page=$('input[name=language1_last_page]').val();
        
        var is_firsttime = true;
        var totalpage = $('input[name="totalpage"]').val();
        totalpage = parseInt(totalpage);
        $('#page').jqPaginator({
            totalPages: totalpage,
            visiblePages: 7,
            currentPage: 1,
            first: '<li class="prev"><a href="javascript:;">' + language1_index + '</a></li>',
            prev: '<li class="prev"><a href="javascript:;">' + language1_previous_page + '</a></li>',
            next: '<li class="next"><a href="javascript:;">' + language1_next_page + '</a></li>',
            page: '<li class="page"><a href="javascript:;">{{page}}</a></li>',
            last: '<li class="prev"><a href="javascript:;">' + language1_last_page + '</a></li>',
            onPageChange: function(num, type) {
                if (is_firsttime) {
                    is_firsttime = false;
                } else {
                    var url = "?app=systemConsole&act=getCouponList&p=" + num;
                    $.get(url, function(res) {
                        $('#content').html(res);
                    });
                }
            }
        });

    });
    var typeId;
    $(document).on('click',".radio-name",function () {
        var id=$(this).attr('data-id');
        // console.log(id);
        typeId=id;
        console.log(typeId)
    });


    /*搜索*/
    $('#submit1').click(function() {
        var area_id = $("#area_id").find("option:selected").val();
        var store_id = $("#store_id").find("option:selected").val();
        totalPage(area_id, store_id);
    });
    function totalPage(area_id, store_id) {
        var language1_index=$('input[name=language1_index]').val();
        var language1_previous_page=$('input[name=language1_previous_page]').val();
        var language1_next_page=$('input[name=language1_next_page]').val();
        var language1_last_page=$('input[name=language1_last_page]').val();
        
        //ajax
        var url = '?app=systemConsole&act=totalPage&area_id=' + area_id + '&store_id=' + store_id;
        $.get(url, function(res) {
            var obj = jQuery.parseJSON(res);
            var r = obj.total;

            $('#page').jqPaginator({
                totalPages: r,
                visiblePages: 7,
                currentPage: 1,
                first: '<li class="prev"><a href="javascript:;">' + language1_index + '</a></li>',
                prev: '<li class="prev"><a href="javascript:;">' + language1_previous_page + '</a></li>',
                next: '<li class="next"><a href="javascript:;">' + language1_next_page + '</a></li>',
                page: '<li class="page"><a href="javascript:;">{{page}}</a></li>',
                last: '<li class="prev"><a href="javascript:;">' + language1_last_page + '</a></li>',
                onPageChange: function(num, type) {
                    //ajax
                    var url = '?app=systemConsole&act=getCouponList&p=' + num + '&area_id=' + area_id + '&store_id=' + store_id;
                    $.get(url, function(res) {
                        $('#content').html(res);
                    });
                }

            });

        });
    }



</script>
{/literal}