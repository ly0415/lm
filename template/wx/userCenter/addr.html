<!DOCTYPE html>
<html style="font-size:50px">
<head lang="en">
    <meta charset="UTF-8">
    <title>新建地址</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
    <link rel="stylesheet" href="{$STATIC_URL}/phone/css/style.css"/>
    <script src="{$STATIC_URL}/phone/js/jquery-2.1.1.min.js"></script>
</head>
<body>
<div class="confirmation">
    <div class="userInfo">
        <label for="name">联系人:</label>
        <input id="name" type="text" placeholder="请填写收货人的姓名" name="name" value="{$name}"/>
    </div>
    <div class="phoneInfo">
        <label for="phone">手机号:</label>
        <input id="phone" type="text" placeholder="请填写收货手机号" name='phone' value="{$phone}"/>
    </div>
    <div class="adress">
        <label>收货地址:</label>
        <input type="text" placeholder="&nbsp天坛" name="address" value="{$address}" readonly/>
    </div>
    <div class="mpInfo">
        <label for="mpNum">门牌号:</label>
        <input id="mpNum" type="text" placeholder="例：16号楼427室" name="mp" value="{$mp}"/>
    </div>
    <!--   <div class="dailyInfo">
           <label for="postal">邮政编码:</label>
           <input id="postal" type="text" placeholder="342300" name="postal" value="{$postal}"/>
       </div>-->
    <div class="footer">
        <button class="submit">保存地址</button>
    </div>
    <input type="hidden"  name="storeid"  value="{$storeid}" >
    <input type="hidden"  name="lang"  value="{$lang}" >
    <input type="hidden"  name="auxiliary"  value="{$auxiliary}" >
    <input type="hidden" name="latlon" value="{$latlon}">
    <input type="hidden" name="returnUrl" value="{$returnUrl}">
    <input type="hidden" name="id" value="{$id}">
    <input type="hidden" name="addr_id" value="{$addr_id}">
    <input type="hidden" name="nowlatlon" value="{$nowlatlon}">
    <input type="hidden" name="url" value="{$url}">

</div>
<script src="{$STATIC_URL}/phone/js/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/common.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/layer/layer.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/mobiscroll.custom-2.17.1.min.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/index.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/plugin/bootstrapswitch/bootstrap-switch.min.js"></script>
<script>
    $("div.dailyInfo>div").on("click", "span", function () {
        $(this).siblings().css('border', '1px solid #C3C3C3');
        if ($(this).hasClass("active")) {
            $(this).css('border', '');
            return false;
        } else {
            $(this).addClass("active").siblings().removeClass("active");
            $(this).css('border', '');
        }
    })
</script>

{literal}
<script type="text/javascript">
    $('input[name=address]').click(function () {
        var name = $('input[name=name]').val();
        var phone = $('input[name=phone]').val();
        var mp = $('input[name=mp]').val();
        var storeid = $('input[name=storeid]').val();
        var lang = $('input[name=lang]').val();
        var auxiliary = $('input[name=auxiliary]').val();
        var latlon = $('input[name=latlon]').val();
        var returnUrl = $('input[name=returnUrl]').val();
        var postal = $('input[name=postal]').val();
        var id = $('input[name=id]').val();
        var addr_id = $('input[name=addr_id]').val();
        var url = $('input[name=url]').val();
        var src = "http://www.njbsds.cn/bspm711/wx.php?app=userCenter"+encodeURIComponent('&')+"act=addAddress"+encodeURIComponent('&')+"addr_id=" + addr_id +encodeURIComponent('&')+"id=" + id +encodeURIComponent('&')+ "storeid=" + storeid +encodeURIComponent('&') +"lang=" + lang  + encodeURIComponent('&')+"username=" + name +
            encodeURIComponent('&')+ "phone=" + phone+encodeURIComponent('&')+"mp=" + mp;
        var txurl="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl="+src+"&key=OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77&referer=myapp";
        window.location.href = txurl;
    })
    $(function () {
        $('.submit').click(function () {
            var name = $('input[name=name]').val();
            var phone = $('input[name=phone]').val();
            var address = $('input[name=address]').val();
            var storeid = $('input[name=storeid]').val();
            var mp = $('input[name=mp]').val();
            var lang = $('input[name=lang]').val();
            var auxiliary = $('input[name=auxiliary]').val();
            var returnUrl = $('input[name=returnUrl]').val();
            var postal = $('input[name=postal]').val();
            var id = $('input[name=id]').val();
            var addr_id = $('input[name=addr_id]').val();
            var nowlatlon = $('input[name=nowlatlon]').val();
            var latlon = $('input[name=latlon]').val();
            var url = $('input[name=url]').val();
            $.ajax({
                url: 'wx.php?app=userCenter&act=doAddress',
                type: 'post',
                data: {'name': name, 'phone': phone, 'address': address, 'storeid': storeid, 'auxiliary': auxiliary, 'lang': lang, 'returnUrl': returnUrl, 'url': url, 'mp': mp, 'postal': postal, 'id': id, 'addr_id': addr_id, 'nowlatlon': nowlatlon, 'latlon': latlon},
                async: false, //默认为true 异步
                success: function (res) {
                    var jsondata = $.parseJSON(res);
                    if (jsondata.status == '1') {
                        layer.open({
                            shade: false
                            , content: '<i class="ico ico-correct"></i>' + jsondata.message
                            , className: 'layer-tip'
                            , time: 2
                        });
                        setTimeout(function () {
                            window.location.href = jsondata.info.url;
                        }, 1000);
                    } else {
                        layer.open({
                            shade: false
                            , content: '<i class="ico ico-error"></i>' + jsondata.message
                            , className: 'layer-tip'
                            , time: 2
                        });
                    }

                }
            });
        })
    })
</script>
{/literal}
</body>
</html>