<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>{$langdata.login_Land}</title><!--登陆-->
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <link href="{$STATIC_URL}/phone/css/mobiscroll.custom-2.17.1.min.css"  rel="stylesheet" type="text/css"/>
    <link href="{$STATIC_URL}/phone/css/style.css"  rel="stylesheet" type="text/css"/>
    <style>
        /*.login-other{*/
        /*margin-top:1rem;*/
        /*}*/
        /*            #send{
                        background-color: #BFA58C;
                        color: #fff;
                        border-radius: 0.1rem;
                        height: 0.5rem;
                        width: 1.5rem;
                        margin-top: 0.25rem;
                        margin-right: 0.2rem;
                    }*/
    </style>
</head>
<body>
<div class="login-wrap">
    <div class="login-tip">{$langdata.login_ShoppingMall}</div><!--您未登陆商城账号，请登录-->
    <div class="login-head tc">
        <img src="{$STATIC_URL}/phone/images/login-head.png">
    </div>
    <div class="login-main  forgetpass-main">
        <ul class="login-item  register-item register-phone">
            <li>
                <i class="ico ico-phone"></i>
                <input type="text" class="text" name="phone" placeholder="输入您的手机号登录" />  <!--输入您的电子邮件/手机号登录。-->
            </li>
            <!--                    <li>
                                    <i class="ico ico-password"></i>
                                    <input id="password" type="password" name="password" placeholder="{$langdata.login_Password}" id="input-password" style="border:0px;background:rgba(0, 0, 0, 0);"/>请输入密码
                                    <button id="send">发送验证码</button>
                                </li> -->
            <li>
                <i class="ico ico-num"></i>
                <input type="text" name="code" placeholder="{$langdata.Input_verificationcode}" class="text inblock" style="width: 50%">
                <a href="##" class="validate-btn getval">{$langdata.Obtain_validation}</a>
                <div class="error" style="display: none;" id="code_error"></div>
            </li>
        </ul>
    </div>
    <input type="hidden" value="{$returnUrl}" name="returnUrl" />
    <input type="hidden" value="{$languages}" name="languages" />
    <input type="hidden" value="{$storeid}" name="storeid" />
    <input type="hidden" value="{$lang}" name="lang" />
    <input type="hidden" value="{$latlon}" name="latlon">
    <input type="hidden" name="userId" value="{$userId}">
    <input type="hidden" name="bindId" value="{$bindId}">

    <div class="login-other">
        <div class="operate clearfix">
            <!--<a href="wx.php?app=user&act=register&storeid={$storeid}&lang={$lang}&latlon={$latlon}&returnUrl={$returnUrl1}" class="fast-login fl">{$langdata.login_register_1}</a>&lt;!&ndash;快速注册&ndash;&gt;-->
           <!-- <a href="wx.php?app=user&act=login&storeid={$storeid}&lang={$lang}&latlon={$latlon}&returnUrl={$returnUrl1}" class="fast-login fl">用户名密码登录</a>
-->
        </div><br><br>
        <a href="#" class="btn btn-big btn-login btn-sub">{$langdata.login_Land}</a><!--暂不登陆，先去逛逛-->
    </div>
    <a href="wx.php?app=default&act=index&storeid={$storeid}&lang={$lang}&latlon={$latlon}"><button type="button" class="btn btn-big btn-white">{$langdata.login_Temporarily}</button></a><!--登陆-->
</div>
<script src="{$STATIC_URL}/phone/js/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/common.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/layer/layer.js" type="text/javascript"></script>
<script src="{$STATIC_URL}/phone/js/mobiscroll.custom-2.17.1.min.js" type="text/javascript"></script>
{literal}
<script>
    $(function () {
        //发送验证码
        var validCode = true;
        $(".getval").click(function () {
            //发送短信验证吗
            $('#phone_error').css('display', 'none');
            var phone = $('input[name="phone"]').val();

            //验证
            if (phone.length == 0) {
                $('#phone_error').css('display', 'block');
                $('#phone_error').text('手机号码必填！');
                return false;
            }
            $.post('wx.php?app=sms&act=sendSms', {'phone': phone}, function (data) {

            });
            //倒计时
            var time = 60;
            var code = $(this);
            code.addClass('active');
            if (validCode) {
                validCode = false;
                var t = setInterval(function () {
                    time--;
                    code.html("已发送" + time + "秒");
                    if (time == 0) {
                        clearInterval(t);
                        code.removeClass('active');
                        code.html("重新获取");
                        validCode = true;
                    }
                }, 1000)
            }
        })
    });
</script>
{/literal}
{literal}
<script type="text/javascript">
    // 点击登录
    $(function () {
        $('.btn-sub').click(function () {
            var phone = $('input[name=phone]').val();
            var code = $('input[name=code]').val();
            var userId=$('input[name=userId]').val();
            var returnUrl = $('input[name=returnUrl]').val();
            var languages = $('input[name=languages]').val();
            var storeid = $('input[name=storeid]').val();
            var lang = $('input[name=lang]').val();
            var latlon = $("input[name='latlon']").val();
            var bindId=$("input[name='bindId']").val();
            $.ajax({
                url: 'wx.php?app=user&act=doquickLogin',
                type: 'post',
                data: {'phone': phone, 'code': code, 'returnUrl': returnUrl, 'languages': languages, 'storeid': storeid, 'lang': lang, 'latlon': latlon,'userId':userId,'bindId':bindId},
                async: false, //默认为true 异步
                error: function () {
                    alert('错误');
                },
                success: function (data) {
                    var data = eval("(" + data + ")");
                    if (data.status == 1) {//用户名不存在需要注册！
                        layer.open({
                            shade: false
                            , content: '<i class="ico ico-correct"></i> ' + data.message
                            , className: 'layer-tip'
                            , time: 2
                        });
                        setTimeout(function () {
                            window.location.href = data.info.url;
                        }, 1000);
                    } else {
                        layer.open({
                            shade: false
                            , content: '<i class="ico ico-error"></i> ' + data.message
                            , className: 'layer-tip'
                            , time: 2
                        });
                    }
                }
            });
        })
    })
</script>
{/literal}
</body>
</html>