<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">
        <title>{$langdata.register_register}</title>
        <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
        <meta content="yes" name="apple-mobile-web-app-capable">
        <meta content="black" name="apple-mobile-web-app-status-bar-style">
        <meta content="telephone=no" name="format-detection">
        <meta content="email=no" name="format-detection">
        <link href="{$STATIC_URL}/phone/css/mobiscroll.custom-2.17.1.min.css"  rel="stylesheet" type="text/css"/>
        <link href="{$STATIC_URL}/phone/css/style.css"  rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <div class="register-wrap">
            <div class="sn-nav">
                <!--                <a href="##" class="sn-nav-close"></a>-->
                <div class="sn-nav-title">{$langdata.register_register}</div>
            </div>
            <ul class="register-title">
                <li class="active">
                    <span  name="switch_lan" value="1">{$langdata.register_phone}</span>
                </li>
<!--                <li>
                    <span  name="switch_lan" value="2">{$langdata.register_mailbox}</span>
                </li>-->
            </ul>
            <div class="register-main forgetpass-main">
                <ul class="register-phone register-item" style="display: block;">
                    <li>
                        <i class="ico ico-phone"></i>
                        <input type="text" name='phone' placeholder="{$langdata.enter_number}" />
                        <!--                        <div class="error" style="display: none;" id="phone_error"></div>-->
                    </li>
                    <li>
                        <i class="ico ico-num"></i>
                        <input type="text" name="code" placeholder="{$langdata.Input_verificationcode}" class="text inblock" style="width: 50%">
                        <a href="##" class="validate-btn getval">{$langdata.Obtain_validation}</a>
                        <div class="error" style="display: none;" id="code_error"></div>
                    </li>
                    <li>
                        <i class="ico ico-recomd"></i>
                        <input type="text" placeholder="{$langdata.register_Recommend}" name='phone_email'/>
                    </li>
                    <li>
                        <i class="ico ico-password"></i>
                        <input type="password" placeholder="{$langdata.login_Password}" name='password' style="border:0px;background:rgba(0, 0, 0, 0);"/>
                        <div class="error" style="display: none;" id="passwd_error"></div>
                        <input name="store_id" type="hidden" value="{$store_id}">
                    </li>
                </ul>
<!--                <ul class="register-email register-item">
                    <li>
                        <i class="ico ico-email"></i>
                        <input type="text" placeholder="{$langdata.register_Electronics}" name='email' />
                    </li>
                    <li>
                        <i class="ico ico-recomd"></i>
                        <input type="text" placeholder="{$langdata.register_Recommend}" name='email_phone'/>
                    </li>
                    <li>
                        <i class="ico ico-password"></i>
                        <input type="password" placeholder="{$langdata.login_Password}"  name='email_password' style="border:0px;background:rgba(0, 0, 0, 0);"/>
                        <input name="email_store_id" type="hidden" value="{$store_id}">
                        <input name="languages" type="hidden" value="{$languages}">
                        <input name="lang" type="hidden" value="{$lang}">
                        <input type="hidden" name="latlon" value="{$latlon}">
                    </li>
                </ul>-->
            </div>
            <div class="register-accept">
                {$langdata.register_accept}
                <span class="red">{$langdata.register_service}</span>
            </div>
            <button type="button" class="btn mt130 btn-sub" id="login_button">{$langdata.register_register}</button>
            <div class="error" style="display: none;" id="callback_result"></div>
            <div class="tc"><a href="wx.php?app=user&act=login&storeid={$storeid}" class="register-hadaccount">{$langdata.register_Alreadyexisting}</a></div>
        </div>
        <input type="hidden" value="{$returnUrl}" name="returnUrl" >
        <script src="{$STATIC_URL}/phone/js/jquery-2.1.1.min.js" type="text/javascript"></script>
        <script src="{$STATIC_URL}/phone/js/common.js" type="text/javascript"></script>
        <script src="{$STATIC_URL}/phone/js/layer/layer.js" type="text/javascript"></script>
        <script src="{$STATIC_URL}/phone/js/mobiscroll.custom-2.17.1.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            // tab切换
            $(function () {
                var spans = $('.register-title').find('li');
                var items = $('.register-main').find('.register-item');
                spans.click(function () {
                    var index = $(this).index();
                    spans.removeClass('active');
                    $(this).addClass('active');
                    items.hide();
                    items.eq(index).show();
                })

            })
        </script>
        {literal}
        <script type="text/javascript">
            $(function () {
                $('.btn-sub').click(function () {
                    var switch_lan = $('.register-title .active').find('[name=switch_lan]').attr("value");
                    if (switch_lan == 1) {
                        var phone = $('input[name=phone]').val();
                        var code = $('input[name=code]').val();
                        var password = $('input[name=password]').val();
                        var phone_email = $('input[name=phone_email]').val();
                        var store_id = $('input[name=store_id]').val();
                        var languages = $('input[name=languages]').val();
                        var lang = $('input[name=lang]').val();
                        var latlon= $("input[name='latlon']").val();
                        var returnUrl=$('input[name=returnUrl]').val();
                        $.ajax({
                            url: 'wx.php?app=user&act=doRegisterChina',
                            type: 'post',
                            data: {'phone': phone, 'code': code, 'phone_email': phone_email, 'password': password, 'store_id': store_id, 'languages': languages, 'lang': lang,'latlon':latlon,'returnUrl':returnUrl},
                            async: false, //默认为true 异步
                            error: function () {
                                alert('error');
                            },
                            success: function (data) {
                                console.log(data);
                                var data = eval("(" + data + ")");
                                if (data.status == 1) {
                                    layer.open({
                                        shade: false
                                        , content: '<i class="ico ico-correct"></i> ' + data.message
                                        , className: 'layer-tip'
                                        , time: 2
                                    });
                                    setTimeout(function () {
                                        window.location.href = data.info.url;
                                    }, 1000);
                                } else {
                                    layer.open({
                                        shade: false
                                        , content: '<i class="ico ico-error"></i> ' + data.message
                                        , className: 'layer-tip'
                                        , time: 2
                                    });
                                }

                            }
                        });
                    } else if (switch_lan == 2) {
                        var email = $('input[name=email]').val();
                        var email_password = $('input[name=email_password]').val();
                        var email_phone = $('input[name=email_phone]').val();
                        var email_store_id = $('input[name=email_store_id]').val();
                        var languages = $('input[name=languages]').val();
                        var lang = $('input[name=lang]').val();
                        var latlon= $("input[name='latlon']").val();
                        $.ajax({
                            url: 'wx.php?app=user&act=doRegister',
                            type: 'post',
                            data: {'email': email, 'email_password': email_password, 'email_phone': email_phone, 'email_store_id': email_store_id, 'languages': languages, 'lang': lang,'latlon':latlon},
                            async: false, //默认为true 异步
                            error: function () {
                                alert('error');
                            },
                            success: function (data) {
                                var data = eval("(" + data + ")");
                                if (data.status == 1) {
                                    layer.open({
                                        shade: false
                                        , content: '<i class="ico ico-correct"></i> ' + data.message
                                        , className: 'layer-tip'
                                        , time: 2
                                    });
                                    window.location.href = data.info.url;
                                } else {
                                    layer.open({
                                        shade: false
                                        , content: '<i class="ico ico-error"></i> ' + data.message
                                        , className: 'layer-tip'
                                        , time: 2
                                    });
                                }

                            }
                        });
                    }
                })
            })
        </script>
        {/literal}
        {if $languages=='ZH'}
        {literal}
        <script>
            $(function () {
                //发送验证码
                var validCode = true;
                $(".getval").click(function () {
                    //发送短信验证吗
                    $('#phone_error').css('display', 'none');
                    var phone = $('input[name="phone"]').val();
                    var reg = /^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/;
                    //验证
                    if (phone.length == 0) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('手机号码必填！');
                        return false;
                    }
                    ;

                    if (!reg.test(phone)) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('手机号码格式错误！');
                        return false;
                    }
                    //
                    $.post('wx.php?app=sms&act=sendSms', {'phone': phone}, function (data) {

                    });
                    //倒计时
                    var time = 60;
                    var code = $(this);
                    code.addClass('active');
                    if (validCode) {
                        validCode = false;
                        var t = setInterval(function () {
                            time--;
                            code.html("已发送" + time + "秒");
                            if (time == 0) {
                                clearInterval(t);
                                code.removeClass('active');
                                code.html("重新获取");
                                validCode = true;
                            }
                        }, 1000)
                    }
                })
            });
        </script>
        {/literal}
         {else}
        {literal}
        <script>
            $(function () {
                //发送验证码
                var validCode = true;
                $(".getval").click(function () {
                    //发送短信验证吗
                    $('#phone_error').css('display', 'none');
                    var phone = $('input[name="phone"]').val();
                    var reg = /^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/;
                    //验证
                    if (phone.length == 0) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('Mobile phone number is required！');
                        return false;
                    }
                    ;

                    if (!reg.test(phone)) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('Mobile phone number format error！');
                        return false;
                    }
                    //
                    $.post('wx.php?app=sms&act=sendSms', {'phone': phone}, function (data) {

                    });
                    //倒计时
                    var time = 60;
                    var code = $(this);
                    code.addClass('active');
                    if (validCode) {
                        validCode = false;
                        var t = setInterval(function () {
                            time--;
                            code.html("Send out" + time + "S");
                            if (time == 0) {
                                clearInterval(t);
                                code.removeClass('active');
                                code.html("Obtain");
                                validCode = true;
                            }
                        }, 1000)
                    }
                })
            });
        </script>
        {/literal}
       
        {/if}
    </body>
</html>