<style>
    button{
        outline:none;
    }
    .active{
        color:#ff0000;
    }
    .productType-item{
        overflow:hidden;
        padding:10px 0;
    }
    .productType-item p{
        float:left;
    }
    .productType-item .btns{
        float:left;
    }
    .productType-item .btns button{
        color:#333;
        border-radius:5px;
        margin-left:10px;
        background-color:#F4F4F4;
        border:1px solid #ADADAD;
    }
    .productType-item .btns button.active{
        color:#fff;
        background-color:#00A65A;
    }
</style>
<div class="height">
    <div class="new-table-responsive">
        <div class="box-body table-responsive no-padding ">
            <div class="box-header">
                <div class="form-inline col-sm-10 col-md-11 no-padding">
                    <div class="form-group form-group-sm form-mar">
                        <input type="text" class="form-control"  value=""  name="gname"  placeholder="请输入商品名称">
                    </div>
                    <div class="form-group form-group-sm form-mar">
                        <button type="button" class="btn btn-default btn-sm" id="submit1">
                            搜索 <i class="fa fa-search"></i>
                        </button>
                    </div>
                </div>
            </div>
            <input type="hidden"  name="totalpage"  value="{$totalpage}" >
            <table class="table tc-box" id="content">
                <thead>
                <tr>
                    <th><input type="checkbox" name="" id="all"/></th>
                    <th>商品图片</th>
                    <th>商品名称</th>
                    <th>市场价格</th>
                    <th>销售价格</th>
                </tr>
                </thead>
                <tbody >
                {foreach from=$data item=item}
                <tr>
                    <td><input type="checkbox" name="check-name" data-name="{$item.goods_name}" data-id="{$item.id}" data-mprice="{$item.market_price}" data-sprice="{$item.shop_price}" data-url="{$item.original_img}"/></td>
                    <td style="width:72px;height:72px;"><img style="width:100%;height:100%" src="{$item.original_img}" width="60" height="50"></td>
                    <td>{$item.goods_name}</td>
                    <td>{$symbol}{$item.market_price}</td>
                    <td>{$symbol}{$item.shop_price}</td>
                </tr>
             <tr>
                    <input type="hidden" value='{$item.spec}' name="spec">
                    <td colspan="5">
                 <div class="productType">
                    <div class="productType-list">
                        {foreach from=$item.specarr item=vo key=k}
                        <div class="productType-item">
                            <p>{$k}:</p>
                            <div class="btns">
                                {foreach from=$vo item=vo2 key=k2}
                                <button  data-id="{$vo2.item_id}"  {if $k2==0} class="active" {/if}  >{$vo2.item}</button>
                                {/foreach}
                            </div>
                        </div>
                        {/foreach}
                    </div>
        </div>
        </td>
        </tr>

        {/foreach}
        </tbody>
        </table>
        <div class="page-box">
            <ul id="page" class="pagination" >
            </ul>
        </div>
    </div>
</div>
</div>

{literal}
<script type="text/javascript">

    $("#content").on("click",".btns button",function(){
        if($(this).hasClass("active")){
        }else{
            $(this).addClass("active").siblings("button.active").removeClass("active");
        }
    });
    // active样式选择
    $(function(){
        $('.tc-box').on('click','.ncbtn',function(){
            $(this).toggleClass('active');
        })
    })
    //属性的显示隐藏
  $(function(){
        $('.tc-box tbody tr:nth-child(even)').css('display','none');
        $('.tc-box').on('click','#all',function(){
            if($(this).is(':checked')){
                $(this).parents('thead').next().find('tr:nth-child(even)').show();
            }else{
                $(this).parents('thead').next().find('tr:nth-child(even)').hide();
            }
        })
        $('.tc-box').on('click','input[name="check-name"]',function(){
            if($(this).is(':checked')){
                $(this).parents('tr').next().show();
            }
            else{
                $(this).parents('tr').next().hide();
            }
        })
    })
    /*分页*/
    $(function(){
        var is_firsttime = true;
        var  totalpage = $('input[name="totalpage"]').val();
        totalpage = parseInt(totalpage);
        $('#page').jqPaginator({
            totalPages:totalpage,
            visiblePages: 7,
            currentPage: 1,
            first: '<li class="prev"><a href="javascript:;">首页</a></li>',
            prev: '<li class="prev"><a href="javascript:;">上一页</a></li>',
            next: '<li class="next"><a href="javascript:;">下一页</a></li>',
            page: '<li class="page"><a href="javascript:;">{{page}}</a></li>',
            last: '<li class="prev"><a href="javascript:;">尾页</a></li>',
            onPageChange:function(num, type){
                if (is_firsttime) {
                    is_firsttime = false;
                } else {
                    //ajax获取
                    var url = '?app=checkDialog&act=getSpikeGoodsList&p='+num;
                    $.get(url,function(res) {
                        $('#content').html(res);
                    });
                }
            }
        });
        /*搜索*/
        $('#submit1').click(function(){
            var  gname =  $.trim($('input[name="gname"]').val()) ;
            totalPage(gname);
        });
        function totalPage(gname){
            //ajax
            var url = '?app=checkDialog&act=totalPage&gname='+gname;
            $.get(url,function(res){
                var obj = jQuery.parseJSON(res);
                var r=  obj.total;
                $('#page').jqPaginator({
                    totalPages:r,
                    visiblePages: 7,
                    currentPage: 1,
                    first: '<li class="prev"><a href="javascript:;">首页</a></li>',
                    prev: '<li class="prev"><a href="javascript:;">上一页</a></li>',
                    next: '<li class="next"><a href="javascript:;">下一页</a></li>',
                    page: '<li class="page"><a href="javascript:;">{{page}}</a></li>',
                    last: '<li class="prev"><a href="javascript:;">尾页</a></li>',
                    onPageChange:function(num, type){
                        var url = '?app=checkDialog&act=getSpikeGoodsList&p='+num+'&gname='+gname;
                        $.get(url,function(res){
                            $('#content').html(res);
                        });
                    }

                });

            })

        }
    })
</script>
{/literal}
