<!DOCTYPE html>
<html>
<head>
    {include file="public/header.html"}
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
    {include file="public/title.html"}
    <!-- Left side column. contains the logo and sidebar -->
    {include file="public/menu.html"}

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
               商品列表
            </h1>
            <ol class="breadcrumb">
                <li><a href="store.php?app=default&act=index"><i class="fa fa-dashboard"></i> 首页</a></li>
                <li class="active">商品管理</li>
                <li class="active">商品列表</li>
            </ol>

        </section>

        <!-- Main content -->
        <section class="content">
            <!-- /.row -->
            <div class="row">
                <div class="col-xs-12">
                    <div class="box box-primary">
                        <div class="box-header">
                            <form class="form-inline col-sm-10 col-md-11 no-padding">
                                <input type='hidden' name='app' value='good'>
                                <input type='hidden' name='act' value='goodList'>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">状态：</small>
                                    <select class="form-control w160 j_select" name="is_sale" >
                                        <option value="0">全部</option>
                                        <option value="1" {if $is_on_sale == 1} selected {/if}>上架</option>
                                        <option value="2" {if $is_on_sale == 2} selected {/if}>下架</option>
                                    </select>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <small class="control-label">名称：</small>
                                    <input type="text" class="form-control"  name='goods_name' value='{$goods_name}'>
                                </div>
                                <div class="form-group form-group-sm form-mar">
                                    <button type="submit" class="btn btn-default btn-sm">
                                        搜索 <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </form>

                            <!--<div class="col-sm-2  col-md-1 no-padding">-->
                                <!--<a class="btn btn-primary pull-right btn-sm" href="?app=good&act=goodAdd" ><i class="fa fa-plus"></i> 添加商品</a>-->
                            <!--</div>-->

                        </div>
                        <div class="new-table-responsive">
                            <div class="box-body table-responsive no-padding">
                                <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>商品名称</th>
                                    <th>所属分类</th>
                                    <th>销售价格</th>
                                    <th>销量</th>
                                    <th>库存</th>
                                    <th>是否包邮</th>
                                    <th>是否推荐</th>
                                    <th>上/下架</th>
                                    <th>操作</th>
                                </tr>
                                </thead>

                                {foreach from=$list item=item}
                                <tr>
                                    <td>{$item.id}</td>
                                    <td>
                                        <div class="clearfix" style="width: 380px;">
                                            <div class="pull-left img-w">
                                                <img src="{$item.original_img}" width="60" height="50">
                                            </div>
                                            <div class="wts ml15 pull-left w300">
                                                {$item.goods_name}</div>
                                            </div>
                                     </div>
                                    </td>
                                    <td>{$item.cat_name}</td>
                                    <td>{$item.shop_price}</td>
                                    <td>{$item.store_count}</td>
                                    <td>{$item.goods_storage}</td>
                                    <td>
                                        {if $item.is_free_shipping ==1}
                                        <p style="margin: 0;">
                                            <input  type="checkbox" name="is_free_shipping" checked  data-value = '{$item.id}'>
                                        </p>
                                        {else}
                                        <p style="margin: 0;">
                                            <input  type="checkbox" name="is_free_shipping"  data-value = '{$item.id}'>
                                        </p>
                                        {/if}
                                    </td>
                                    <td>
                                        {if $item.is_recommend ==1}
                                        <p style="margin: 0;">
                                            <input  type="checkbox" name="is_recommend" checked  data-value = '{$item.id}'>
                                        </p>
                                        {else}
                                        <p style="margin: 0;">
                                            <input  type="checkbox" name="is_recommend"  data-value = '{$item.id}'>
                                        </p>
                                        {/if}
                                    </td>
                                     <td>
                                       {if $item.is_on_sale ==1}
                                        <p style="margin: 0;">
                                        <input  type="checkbox" name="is_on_sale" checked data-value = '{$item.id}' >
                                         </p>
                                         {else}
                                         <p style="margin: 0;">
                                             <input  type="checkbox" name="is_on_sale"  data-value = '{$item.id}' >
                                         </p>
                                         {/if}
                                     </td>
                                     <td class="cz">
                                        <a href="index.php?app=goods&act=goodInfo&goods_id={$item.goods_id}" data-toggle="tooltip" title="" class="btn btn-xs btn-success edit-table" style="overflow: hidden; position: relative;">查看详情</a>
                                        <a href="store.php?app=good&act=editGood&id={$item.id}" data-toggle="tooltip" title="" class="btn btn-xs btn-success edit-table" style="overflow: hidden; position: relative;">编辑商品</a>
                                        <a href="javascript:void(0)" data-toggle="tooltip" title="" class="btn btn-xs btn-danger delete-table" style="overflow: hidden; position: relative;"  onclick="shanchu('{$item.id}');">删除</a>
                                    </td>

                                </tr>
                                {/foreach}

                            </table>
                            </div>
                        </div>
                        <div class="box-footer clearfix">
                            {$ph}
                        </div>
                        <!-- /.box-body -->
                    </div>
                </div>
            </div>
        </section>
        <!-- /.content -->

    </div>
{include file="public/footer.html"}
</div>
{literal}
<script type="text/javascript">
    $('#add-user').click(function () {
        dialog_form('?app=member&act=add', '添加人员');
    });

    /*编辑*/
    function bianj(id) {
        dialog_form('?app=member&act=edit&id=' + id, '编辑人员');
    }

    /*删除*/
    function shanchu(id) {
        deletes('?app=member&act=dele&id=' + id);
    }
    $(function(){
        // 是否上架js
      $("[name='is_on_sale']").bootstrapSwitch({
         onText:"是",
         offText:"否",
        size:"mini",
        onSwitchChange:function(event,state){
            if(state==true){
                var id  = $(this).attr('data-value');
                $(this).val("1");
                var is_on_sale = $(this).val();
                $.ajax({
                    url: 'store.php?app=good&act=changeSales',
                    type: 'POST',
                    data: {'id':id,'is_on_sale':is_on_sale},
                    dataType: "json",
                    success:function(msg) {
                        if(msg.status==1){
//                            window.location.reload();
                            //setTimeout(function(){window.location.reload();},1000);
                        }else{
                            var d=$.dialog({
                                content: '<div class="text-center">'+msg.message+'</div>',
                                title: false, // hides the title.
                                closeIcon: false, // hides the close icon.
                                columnClass: 'xsmall',
                                onOpen: function(){
                                    setTimeout(function(){
                                        d.close();
                                    }, 400);
                                }
                            });
                            setTimeout(function(){window.location.reload();},1000);
                        }
                    }
                });
            }else{
                var id  = $(this).attr('data-value');
                $(this).val("2");
                var is_on_sale = $(this).val();
                $.ajax({
                    url: 'store.php?app=good&act=changeSales',
                    type: 'POST',
                    data: {'id':id,'is_on_sale':is_on_sale},
                    dataType: "json",
                    success:function(msg) {
                        if(msg.status==1){
//                            window.location.reload();
                            //setTimeout(function(){window.location.reload();},1000);
                        }else{
                            var d=$.dialog({
                                content: '<div class="text-center">'+msg.message+'</div>',
                                title: false, // hides the title.
                                closeIcon: false, // hides the close icon.
                                columnClass: 'xsmall',
                                onOpen: function(){
                                    setTimeout(function(){
                                        d.close();
                                    }, 400);
                                }
                            });
                            setTimeout(function(){window.location.reload();},1000);
                        }
                    }
                });
            }
        }
      });
        // 是否推荐
        $("[name='is_recommend']").bootstrapSwitch({
            onText:"是",
            offText:"否",
            size:"mini",
            onSwitchChange:function(event,state){
                if(state==true){
                    var id  = $(this).attr('data-value');
                    $(this).val("1");
                    var is_recommend = $(this).val();
                    $.ajax({
                        url: 'store.php?app=good&act=changeRecommend',
                        type: 'POST',
                        data: {'id':id,'is_recommend':is_recommend},
                        dataType: "json",
                        success:function(msg) {
                            if(msg.status==1){
//                                window.location.reload();
                                //setTimeout(function(){window.location.reload();},1000);
                            }else{
                                var d=$.dialog({
                                    content: '<div class="text-center">'+msg.message+'</div>',
                                    title: false, // hides the title.
                                    closeIcon: false, // hides the close icon.
                                    columnClass: 'xsmall',
                                    onOpen: function(){
                                        setTimeout(function(){
                                            d.close();
                                        }, 400);
                                    }
                                });
                                setTimeout(function(){window.location.reload();},1000);
                            }
                        }
                    });
                }else{
                    var id  = $(this).attr('data-value');
                    $(this).val("0");
                    var is_recommend = $(this).val();
                    $.ajax({
                        url: 'store.php?app=good&act=changeRecommend',
                        type: 'POST',
                        data: {'id':id,'is_recommend':is_recommend},
                        dataType: "json",
                        success:function(msg) {
                            if(msg.status==1){
//                                window.location.reload();
                                //setTimeout(function(){window.location.reload();},1000);
                            }else{
                                var d=$.dialog({
                                    content: '<div class="text-center">'+msg.message+'</div>',
                                    title: false, // hides the title.
                                    closeIcon: false, // hides the close icon.
                                    columnClass: 'xsmall',
                                    onOpen: function(){
                                        setTimeout(function(){
                                            d.close();
                                        }, 400);
                                    }
                                });
                                setTimeout(function(){window.location.reload();},1000);
                            }
                        }
                    });

                }
            }
        });
        // 是否推荐
        $("[name='is_free_shipping']").bootstrapSwitch({
            onText:"是",
            offText:"否",
            size:"mini",
            onSwitchChange:function(event,state){
                if(state==true){
                    var id  = $(this).attr('data-value');
                    $(this).val("1");
                    var is_free_shipping = $(this).val();
                    $.ajax({
                        url: 'store.php?app=good&act=changeFree',
                        type: 'POST',
                        data: {'id':id,'is_free_shipping':is_free_shipping},
                        dataType: "json",
                        success:function(msg) {
                            if(msg.status==1){
//                                window.location.reload();
                                //setTimeout(function(){window.location.reload();},1000);
                            }else{
                                var d=$.dialog({
                                    content: '<div class="text-center">'+msg.message+'</div>',
                                    title: false, // hides the title.
                                    closeIcon: false, // hides the close icon.
                                    columnClass: 'xsmall',
                                    onOpen: function(){
                                        setTimeout(function(){
                                            d.close();
                                        }, 400);
                                    }
                                });
                                setTimeout(function(){window.location.reload();},1000);
                            }
                        }
                    });
                }else{
                    var id  = $(this).attr('data-value');
                    $(this).val("2");
                    var is_free_shipping = $(this).val();
                    $.ajax({
                        url: 'store.php?app=good&act=changeFree',
                        type: 'POST',
                        data: {'id':id,'is_free_shipping':is_free_shipping},
                        dataType: "json",
                        success:function(msg) {
                            if(msg.status==1){
//                                window.location.reload();
                                //setTimeout(function(){window.location.reload();},1000);
                            }else{
                                var d=$.dialog({
                                    content: '<div class="text-center">'+msg.message+'</div>',
                                    title: false, // hides the title.
                                    closeIcon: false, // hides the close icon.
                                    columnClass: 'xsmall',
                                    onOpen: function(){
                                        setTimeout(function(){
                                            d.close();
                                        }, 400);
                                    }
                                });
                                setTimeout(function(){window.location.reload();},1000);
                            }
                        }
                    });
                }
            }
        });

    });
</script>
<script type="text/javascript">
    function shanchu(id){
        deletes('?app=good&act=dele&id='+id);
    }
</script>
{/literal}
</body>
</html>