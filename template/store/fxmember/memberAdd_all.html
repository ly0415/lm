<!DOCTYPE html>
<html>
    <head>

        {include file="public/header.html"}

    </head>
    <body class="hold-transition skin-blue sidebar-mini">
        <div class="wrapper">

            {include file="public/title.html"}
            <!-- Left side column. contains the logo and sidebar -->
            {include file="public/menu.html"}

            <!-- Content Wrapper. Contains page content -->
            {if $lang_id ==1}
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>
                        Distribution staff added
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="store.php?app=default&act=index"><i class="fa fa-dashboard"></i> Home</a></li>
                        <li class="active">Distribution management</li>
                        <li class="active">Distribution staff added</li>
                    </ol>
                </section>

                <!-- Main content -->
                <section class="content">
                    <div class="row">
                        <!-- right column -->
                        <div class="col-xs-12">
                            <!-- Horizontal Form -->
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title"></h3>
                                </div>
                                <!-- /.box-header -->
                                <!-- form start -->
                                <form class="form-horizontal" action="?app=fxmember&act=doadd"  data-type="ajax" method="post">
                                    <div class="box-body">
                                        <input type="hidden" value="{$lang_id}" name="lang_id" />

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Member name：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="user_name"  value="" readonly>
                                                <input type="hidden" class="form-control" name="user_id"  value="" >
                                            </div>
                                            <div class="col-xs-1"><span class="btn btn-primary" id="useradd" >Lookup</span></div>
                                        </div>


                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Store-level：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select"  name="store_id"  onchange="getstore(this)" >
                                                    <option value=''>choose store</option>
                                                    {foreach from=$store_data  item=val}
                                                    <option value='{$val.id}'>{$val.store_name}</option>
                                                    {/foreach}
                                                </select>
                                            </div>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select fxlev"  name="fxlev"  onchange="whichdis(this)" >
                                                    <option value=''>level</option>
                                                    <option value='1'>level_1</option>
                                                    <option value='2'>level_2</option>
                                                    <option value='3'>level_3</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group display3"  style="display: none" >
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>Recommend：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select pidpid3"  name="pidpid3"  onchange="getchids(this)" >
                                                    <option value="0">--choose level1--</option>
                                                </select>

                                            </div>
                                            <div class="col-sm-2 ">
                                                <select class="form-control j_select"  name="pid3"  id="tager"   >
                                                    <option value="0">--choose level2--</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group  display3 "  style="display: none">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> discount：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="fx_discount"  value=""  >
                                            </div>
                                        </div>


                                        <div class="form-group" id="display2"   style="display: none">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>Recommend：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select" name="pid2"    id="pid2">
                                                    <option value="0">--choose level1--</option>
                                                    <option value='{$val.id}'>{$val.real_name}</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group" id="display1"  style="display: none" >
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>Rule：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select" name="fx_rule"    id="fx_rule">
                                                    <option value="0">--choose rule--</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Real name：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="real_name" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Phone number：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="telephone" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Mailbox account：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="email" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Account opening bank：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="bank_name" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> Bank account：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="bank_account" >
                                            </div>
                                        </div>


                                    </div>
                                    <!-- /.box-body -->
                                    <div class="box-footer">
                                        <div class="form-group">
                                            <div class="col-sm-6 col-sm-offset-4 col-md-5 col-md-offset-2 col-lg-4 col-lg-offset-2">
                                                <a href="store.php?app=fxmember&act=memlist&lang_id={$lang_id}" class="btn btn-default"><i class="fa fa-times-circle"></i> Close</a>
                                                <button class="btn btn-primary pull-right" id="submit"><i class="fa fa-save"></i> Preservation</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <!-- /.box -->
                                <!-- general form elements disabled -->
                            </div>
                            <!-- /.box -->
                        </div>
                        <!--/.col (right) -->
                    </div>
                    <!-- /.row -->
                </section>
                <!-- /.content -->
            </div>
            <!-- /.content-wrapper -->
            {include file="public/footer.html"}
            {else}
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>
                        分销人员添加
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="store.php?app=default&act=index"><i class="fa fa-dashboard"></i> 首页</a></li>
                        <li class="active">分销管理</li>
                        <li class="active">分销人员添加</li>
                    </ol>
                </section>

                <!-- Main content -->
                <section class="content">
                    <div class="row">
                        <!-- right column -->
                        <div class="col-xs-12">
                            <!-- Horizontal Form -->
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title"></h3>
                                </div>
                                <!-- /.box-header -->
                                <!-- form start -->
                                <form class="form-horizontal" action="?app=fxmember&act=doadd"  data-type="ajax" method="post">
                                    <div class="box-body">
                                        <input type="hidden" value="{$lang_id}" name="lang_id" />

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 会员名称：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="user_name"  value="" readonly>
                                                <input type="hidden" class="form-control" name="user_id"  value="" >
                                                <input type="hidden" class="form-control" name="type"  value="all" >
                                            </div>
                                            <div class="col-xs-1"><span class="btn btn-primary" id="useradd" >查找</span></div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 分销店铺-等级：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select"  name="store_id"  onchange="getstore(this)" >
                                                    <option value=''>请选择店铺</option>
                                                    {foreach from=$store_data  item=val}
                                                    <option value='{$val.id}'>{$val.store_name}</option>
                                                    {/foreach}
                                                </select>
                                            </div>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select fxlev"  name="fxlev"  onchange="whichdis(this)" >
                                                    <option value=''>分销等级</option>
                                                    <option value='1'>一级分销</option>
                                                    <option value='2'>二级分销</option>
                                                    <option value='3'>三级分销</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group display3"  style="display: none" >
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>推荐人员：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select pidpid3"  name="pidpid3"  onchange="getchids(this)" >
                                                    <option value="0">--请选择一级--</option>
                                                </select>

                                            </div>
                                            <div class="col-sm-2 ">
                                                <select class="form-control j_select"  name="pid3"  id="tager"   >
                                                    <option value="0">--请选择二级--</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group  display3 "  style="display: none">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 优惠比例：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="fx_discount"  value=""  >
                                            </div>
                                        </div>


                                        <div class="form-group" id="display2"   style="display: none">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>推荐人员：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select" name="pid2"    id="pid2">
                                                    <option value="0">--请选择一级--</option>
                                                    <option value='{$val.id}'>{$val.real_name}</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group" id="display1"  style="display: none" >
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span>分销规则：</label>
                                            <div class="col-sm-2">
                                                <select class="form-control j_select" name="fx_rule"    id="fx_rule">
                                                    <option value="0">--请选择规则--</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 真实姓名：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="real_name" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 手机号码：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="telephone" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 邮箱帐号：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="email" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 开户银行：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="bank_name" >
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-sm-4 col-md-2  col-lg-2 control-label"><span class="text-red">*</span> 银行帐号：</label>
                                            <div class="col-sm-6 col-md-5 col-lg-4">
                                                <input type="text" class="form-control" name="bank_account" >
                                            </div>
                                        </div>


                                    </div>
                                    <!-- /.box-body -->
                                    <div class="box-footer">
                                        <div class="form-group">
                                            <div class="col-sm-6 col-sm-offset-4 col-md-5 col-md-offset-2 col-lg-4 col-lg-offset-2">
                                                <a href="store.php?app=fxmember&act=memlist&lang_id={$lang_id}" class="btn btn-default"><i class="fa fa-times-circle"></i> 关 闭</a>
                                                <button class="btn btn-primary pull-right" id="submit"><i class="fa fa-save"></i> 保 存</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <!-- /.box -->
                                <!-- general form elements disabled -->
                            </div>
                            <!-- /.box -->
                        </div>
                        <!--/.col (right) -->
                    </div>
                    <!-- /.row -->
                </section>
                <!-- /.content -->
            </div>
            <!-- /.content-wrapper -->
            {include file="public/footer.html"}
            {/if}


        </div>
        {if $lang_id == 1}
        {literal}
        <script type="text/javascript">
            //选择会员
            $('#useradd').click(function() {
                setTimeout(function() {
                    dialog_form_radio('store.php?app=userDialog&act=userDialog', 'Add');
                }, 100);
            });
            function dialog_form_radio(file_url, title) {
                $.get(file_url, function(data) {
                    $.confirm({
                        boxWidth: '50%',
                        useBootstrap: false,
                        title: title,
                        content: data,
                        animationBounce: 1.5,
                        type: 'blue',
                        buttons: {
                            confirm: {
                                btnClass: 'btn-blue',
                                text: '保存',
                                action: function() {
                                    var obj = $('.tc-box tbody input[type="radio"]:checked');
                                    dataname = obj.attr('data-name');
                                    dataid = obj.attr('data-id');
                                    $('input[name="user_name"]').val(dataname);
                                    $('input[name="user_id"]').val(dataid);
//                                    $('input[name="email"]').val(dataname);
                                }
                            },
                            cancel: {
                                btnClass: 'btn-default', // multiple classes.
                                text: 'cancel'
                            }
                        }
                    });

                })
            }
            //选择店铺
            function getstore(obj){
                var store_id = parseInt(obj.value);
                getfirst(store_id);
                getfxrule(store_id);
                $("#display1").hide();
                $("#display2").hide();
                $(".display3").hide();
                var html = "";
                html += '<option >' + 'level' + '</option>';
                html += '<option value=" 1">' + 'level_1' + '</option>';
                html += '<option value=" 2">' + 'level_2' + '</option>';
                html += '<option value=" 3">' + 'level_3' + '</option>';
                $('.fxlev').html('');
                $('.fxlev').html(html);
            }
            function whichdis (obj){
                var val = parseInt(obj.value);
                if(val == 1){
                    $("#display1").show();
                    $("#display2").hide();
                    $(".display3").hide();
                }
                if(val == 2){
                    $("#display1").hide();
                    $("#display2").show();
                    $(".display3").hide();
                }
                if(val == 3){
                    $("#display1").hide();
                    $("#display2").hide();
                    $(".display3").show();
                }
            }
            //获取一级分销商
            function getfirst(store_id){
                var url = 'store.php?app=fxmember&act=ajaxgetfirst&store_id=' + store_id;
                var html = '<option value="0">--choose level1--</option>';
                $.get(url, function(res) {
                    $.each(res, function(key, value) {
                        html += '<option value="' + value.id + '">' + value.real_name + '</option>';
                    });
                    $('.pidpid3').html('');
                    $('.pidpid3').html(html);
                    $('#pid2').html('');
                    $('#pid2').html(html);
                }, 'json');
            }
            //获取分销规则
            function getfxrule(store_id){
                var url = 'store.php?app=fxmember&act=ajaxgetrule&store_id=' + store_id;
                var html = '<option value="0">--请选择--</option>';
                $.get(url, function(res) {
                    $.each(res, function(key, value) {
                        html += '<option value="' + value.id + '">' + value.rule_name + '</option>';
                    });
                    $('#fx_rule').html('');
                    $('#fx_rule').html(html);
                }, 'json');
            }

            //
            function  getchids(obj) {
                var ppid = parseInt(obj.value);
                //alert(id);
                var html = '<option value="0">--choose level2--</option>';
                if (ppid == 0) {
                    $('#tager').html(html);
                } else {
                    var url = 'store.php?app=fxmember&act=ajaxgetchids&ppid=' + ppid;
                    $.get(url, function(res) {
                        $.each(res, function(key, value) {
                            html += '<option value="' + value.id + '">' + value.real_name + '</option>';
                        });
                        $('#tager').html(html);
                    }, 'json');
                }
            }
            //优惠比例
            function  getdis() {
                var url = 'store.php?app=fxmember&act=ajaxDiscount';
                $.get(url, function(res) {

                    var dis = res.dis;
                    $('input[name="fx_discount"]').val(dis);

                }, 'json');

            }


        </script>

        {/literal}
        {else}
        <script type="text/javascript">
            //选择会员
            $('#useradd').click(function() {
                setTimeout(function() {
                    dialog_form_radio('store.php?app=userDialog&act=userDialog', '添加会员');
                }, 100);
            });
            function dialog_form_radio(file_url, title) {
                $.get(file_url, function(data) {
                    $.confirm({
                        boxWidth: '50%',
                        useBootstrap: false,
                        title: title,
                        content: data,
                        animationBounce: 1.5,
                        type: 'blue',
                        buttons: {
                            confirm: {
                                btnClass: 'btn-blue',
                                text: '保存',
                                action: function() {
                                    var obj = $('.tc-box tbody input[type="radio"]:checked');
                                    dataname = obj.attr('data-name');
                                    dataid = obj.attr('data-id');
                                    $('input[name="user_name"]').val(dataname);
                                    $('input[name="user_id"]').val(dataid);
//                                    $('input[name="email"]').val(dataname);
                                }
                            },
                            cancel: {
                                btnClass: 'btn-default', // multiple classes.
                                text: '取消'
                            }
                        }
                    });

                })
            }
            //选择店铺
            function getstore(obj){
                var store_id = parseInt(obj.value);
                getfirst(store_id);
                getfxrule(store_id);
                $("#display1").hide();
                $("#display2").hide();
                $(".display3").hide();
                var html = "";
                html += '<option >' + '分销等级' + '</option>';
                html += '<option value=" 1">' + '一级分销' + '</option>';
                html += '<option value=" 2">' + '二级分销' + '</option>';
                html += '<option value=" 3">' + '三级分销' + '</option>';
                $('.fxlev').html('');
                $('.fxlev').html(html);
            }
            function whichdis (obj){
                var val = parseInt(obj.value);
                if(val == 1){
                    $("#display1").show();
                    $("#display2").hide();
                    $(".display3").hide();
                }
                if(val == 2){
                    $("#display1").hide();
                    $("#display2").show();
                    $(".display3").hide();
                }
                if(val == 3){
                    $("#display1").hide();
                    $("#display2").hide();
                    $(".display3").show();
                }
            }
            //获取一级分销商
            function getfirst(store_id){
                var url = 'store.php?app=fxmember&act=ajaxgetfirst&store_id=' + store_id;
                var html = '<option value="0">--请选择一级--</option>';
                $.get(url, function(res) {
                    $.each(res, function(key, value) {
                        html += '<option value="' + value.id + '">' + value.real_name + '</option>';
                    });
                    $('.pidpid3').html('');
                    $('.pidpid3').html(html);
                    $('#pid2').html('');
                    $('#pid2').html(html);
                }, 'json');
            }
            //获取分销规则
            function getfxrule(store_id){
                var url = 'store.php?app=fxmember&act=ajaxgetrule&store_id=' + store_id;
                var html = '<option value="0">--请选择--</option>';
                $.get(url, function(res) {
                    $.each(res, function(key, value) {
                        html += '<option value="' + value.id + '">' + value.rule_name + '</option>';
                    });
                    $('#fx_rule').html('');
                    $('#fx_rule').html(html);
                }, 'json');
            }

            //
            function  getchids(obj) {
                var ppid = parseInt(obj.value);
                //alert(id);
                var html = '<option value="0">--请选择二级--</option>';
                if (ppid == 0) {
                    $('#tager').html(html);
                } else {
                    var url = 'store.php?app=fxmember&act=ajaxgetchids&ppid=' + ppid;
                    $.get(url, function(res) {
                        $.each(res, function(key, value) {
                            html += '<option value="' + value.id + '">' + value.real_name + '</option>';
                        });
                        $('#tager').html(html);
                    }, 'json');
                }
            }
            //优惠比例
            function  getdis() {
                var url = 'store.php?app=fxmember&act=ajaxDiscount';
                $.get(url, function(res) {

                    var dis = res.dis;
                    $('input[name="fx_discount"]').val(dis);

                }, 'json');

            }


        </script>
        {/if}
    </body>
</html>


