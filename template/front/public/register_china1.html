<!DOCTYPE html>
<html>
    <head>
        <title>home 711</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" type="text/css" href="{$STATIC_URL}/front/css/base.css">
        <!-- iCheck -->
        <link rel="stylesheet" href="{$STATIC_URL}/plugin/iCheck/square/blue.css">
    </head>
    <body style="background-color:#fff;">
        <div class="container clearfix login-header">

            <div style="width:240px;margin-top:8px;float:left;">
                <a href="index.php?storeid={$storeid}&lang={$langid}" class="logo fl mt20">
                    <img src="{$webconf.store_logo.value}" style="width:100%">
                </a>
            </div>

            <div class="login fr">
                {$langdata.login_security}
                <i class="ico-lock ico"></i>
            </div>
        </div>
        <div class="login-box ">
            <div>
                <div class="login-tit" style="margin-bottom:20px;">
                    手机号快捷登录
                </div>

                <div class="login-content">
                    <p>
                        <input type="text" name="phone" placeholder="{$langdata.enter_number}" class="text" value="{$username}">
                    <div class="error" style="display: none;" id="phone_error"></div>
                    </p>

                    <!--<p class=" password">-->
                    <!--<input type="password" name="passwd"  placeholder="{$langdata.login_Password}" class="text"><span class="show">{$langdata.login_display}</span></p>-->
                    <!--<div class="error" style="display: none;" id="passwd_error"></div>-->
                    <!--</p>-->
                    <!--<p>-->
                    <!--<input type="text" name="recom" placeholder="{$langdata.recom}" class="text">-->
                    <!--<div class="error" style="display: none;" id="recom_error"></div>-->
                    <!--</p>-->

                    <p>
                        <input type="text" name="code" placeholder="{$langdata.Input_verificationcode}" class="text inblock" style="width: 50%">
                        <a href="javascript:;" class="btn-sub inblock fr getval" style="width: 45%">{$langdata.Obtain_validation}</a>
                    <div class="error" style="display: none;" id="code_error"></div>
                    </p>
                    <input name="storeid" type="hidden" value="{$storeid}">
                    <input name="langid" type="hidden" value="{$langid}">
                    <p class="other">
                        <a href="index.php?app=user&act=login_step&lang={$langid}&username={base64_encode($username)}&returnUrl={$returnUrl}&returnUrl1={$returnUrl1}">账号密码登录</a>
                        <a href="index.php?app=user&act=login">注册</a>
                    </p>
                    <p><button class="btn-sub" id="regist" >登录</button> </p>
                </div>

            </div>
        </div>
        <div class="login-footer">
            <p class="web">www.711home.com www.711home.net</p>
            <p>Copyright @ 2003-2016 {$langdata.login_Amy}</p>
        </div>

        <script type="text/javascript" src="{$STATIC_URL}/front/js/jquery.1.8.2.min.js"></script>
        <!-- iCheck -->
        <script src="{$STATIC_URL}/plugin/iCheck/icheck.min.js"></script>
        <script type="text/javascript" src="{$STATIC_URL}/front/js/common.js"></script>
        <script type="text/javascript" src="{$STATIC_URL}/front/plus/layer/layer.js"></script>
        <script>
            $(function () {
                $('input').iCheck({
                    checkboxClass: 'icheckbox_square-blue',
                    radioClass: 'iradio_square-blue',
                    increaseArea: '20%' // optional
                });
                document.onkeydown = function (event) {
                    e = event ? event : (window.event ? window.event : null);
                    if (e.keyCode == 13) {
                        var button = document.getElementById('login_button');
                        button.focus();
                        button.onclick();
                    }
                };
            });
        </script>
        {literal}
        <script type="text/javascript">
            $(function () {
                //发送验证码
                var validCode = true;
                $(".getval").click(function () {
                    //发送短信验证吗
                    $('#phone_error').css('display', 'none');
                    var phone = $('input[name="phone"]').val();
                    var reg = /^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])\d{8}$/;
                    //验证
                    if (phone.length == 0) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('手机号码必填！');
                        return false;
                    }

                    if (!reg.test(phone)) {
                        $('#phone_error').css('display', 'block');
                        $('#phone_error').text('手机号码格式错误！');
                        return false;
                    }
                    //
                    $.post('index.php?app=sms&act=sendSms', {'phone': phone}, function (data) {

                    });
                    //倒计时
                    var time = 60;
                    var code = $(this);
                    code.addClass('active');
                    if (validCode) {
                        validCode = false;
                        var t = setInterval(function () {
                            time--;
                            code.html("已发送" + time + "秒");
                            if (time == 0) {
                                clearInterval(t);
                                code.removeClass('active');
                                code.html("重新获取");
                                validCode = true;
                            }
                        }, 1000)
                    }
                })
            });
        </script>
        {/literal}
        {literal}
        <script type="text/javascript">
            // 点击登录&&注册
            $(function () {
                $('#regist').click(function () {
                    var phone = $('input[name=phone]').val();
                    var code = $('input[name=code]').val();
                    var storeid = $('input[name=storeid]').val();
                    var lang = $('input[name=langid]').val();

                    $.ajax({
                        url: 'index.php?app=user&act=dologin_stepk',
                        type: 'post',
                        data: {'phone': phone, 'code': code, 'storeid': storeid, 'lang': lang},
                        async: false, //默认为true 异步
                        error: function () {
                            alert('错误');
                        },
                        success: function (data) {
                            var data = eval("(" + data + ")");
                            var status = data.status;
                            var message = data.message;
                            if (status == 1) {
                                layer.alert(message, {
                                    icon: 0,
                                    btn: false,
                                    title: false,
                                    closeBtn: 0,
                                    time: 2000,
                                    skin: 'alt-layer'
                                });
                                setTimeout(function () {
                                    window.location.href = data.info.url;
                                }, 2500);
                            } else {
                                layer.alert(message, {
                                    icon: 0,
                                    btn: false,
                                    title: false,
                                    closeBtn: 0,
                                    time: 2000,
                                    skin: 'alt-layer'
                                });
                            }
                        }
                    });
                })
            })
        </script>
        {/literal}
    </body>
</html>