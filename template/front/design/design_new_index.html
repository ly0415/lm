<!DOCTYPE html>
<html>
<head>
	<title>design search</title>
	<meta charset="utf-8" />
	{include file="public/header.html"}
</head>
<body style="background-color: #fff;" class="designindex-wrap">
      {include file="public/daohang.html"}

	<!-- navs-box end -->
	<div class="border"></div>
	<div style="background-color: #fff;">
		<div class="design-index">
			<div class="">
				<img src="{$STATIC_URL}/front/images/design-index.png" width="850" height="120" class="topimg">
				<div class="searchbox clearfix container1">
					<div class="fl citybox">
						<a href="##" class="city" id="city">{$langdata.country}</a>
						<!-- city -->
						<div class="city-box">
							<div class="hot-city">
								<p>热门城市</p>
								<ul class="clearfix" id="js_hotcitys">
									{foreach  from =$hotCity item = ht}
									<li cityId = {$ht.cityid} >{$ht.name}</li>
									{/foreach}
								</ul>
							</div>
							<div class="province">
								<p>选择省份</p>

								<ul class="clearfix provlist" >
									{foreach from=$areas item=vo}
									<li>
										<span class="provname">{$vo.province}</span>
										<div class="tabbox">
											<ul class="js_provCitys">
												{foreach from=$vo.cities item = v1}
												<li class="js_cityName" cityid = {$v1.cityid}>{$v1.name}</li>
												{/foreach}
											</ul>
										</div>
									</li>
									{/foreach}
								</ul>

							</div>
						</div>
						<input type="hidden" name="cityId" value="0"/>
					</div>
					<div class="fl search">
						<input type="text" class="sch-text fl" placeholder="{$langdata.area_name}" name="area" />
						<input type="hidden" name="store_id" value="{$store_id}"/>
						<input type="hidden" value="{$lang_id}" name="lang_id" />
						<span class="sch-btn fl" id="search"></span>
					</div>
					<div class="createbox" style ="bottom: -60px;">{$langdata.tip}<a href="?app=design&act=index&storeid={$store_id}&lang={$lang_id}" id="create">&nbsp;&nbsp;<i>{$langdata.tip_design}</i>&nbsp;&nbsp;</a>{$langdata.tip_one}</div>
				</div>
				<ul class="resultlist clearfix">
					<!--<li>-->
						<!--<a href="design-create.html">-->
							<!--<img src="./images/design-index.png" width="255" height="285">-->
							<!--<p class="">北京市56m³3室两厅1卫</p>-->
							<!--<p class="">碧桂园</p>-->
							<!--<span class="choose">选择</span>-->
						<!--</a>-->
					<!--</li>-->
					<!--<li>-->
						<!--<a href="design-create.html">-->
							<!--<img src="./images/design-index.png" width="255" height="285">-->
							<!--<p class="">北京市56m³3室两厅1卫</p>-->
							<!--<p class="">碧桂园</p>-->
							<!--<span class="choose">选择</span>-->
						<!--</a>-->
					<!--</li>-->
				</ul>
			</div>
		</div>
	</div>


  {include file="public/footer.html"}
	  {literal}
<script type="text/javascript">
	$(function(){
		$(document).on("click",function(e)
	    {
		        if($(e.target).parents(".provlist").length == 0)
		        {
		            $('.city-box').hide();
		        }
		});

//		$('.citybox').mouseover(function(){
//			$('.city-box').show();
//			$("#city").removeClass("city").addClass("city1");
//		})
//		$('.citybox').mouseout(function(){
////			$('.city-box').hide();
//			$("#city").removeClass("city1").addClass("city");
//		})
		// 点击省份下级显示隐藏
		$('.city-box').on('click','.provname',function(){
			if($(this).hasClass('active')){
				$(this).removeClass('active');
				$(this).next().hide();
			}else{
				$(this).addClass('active').next().show().parent().siblings().find('span').removeClass('active').next().hide();
			}
		});

		//点击省份二级和热门城市替换文本
		$('.city-box').on('click','.js_provCitys li',function(){
			var text = $(this).text();
            var cityId = $(this).attr('cityid');
            $('input[name=cityId]').val(cityId);
			$(this).parents('.city-box').hide();
			$(this).parent().parent().prev().removeClass('active');
			$(this).parent().parent().hide();
			$('#city').text(text);
		})
        $('.city-box').on('click','#js_hotcitys li',function(){
            var text = $(this).text();
            var cityId = $(this).attr('cityid');
			$('input[name=cityId]').val(cityId);
            $(this).parents('.city-box').hide();
            $('#city').text(text);
        })
	})

	$('#search').click(function(){
	   var cityId = $('input[name=cityId]').val();
	   var q = $('input[name=area]').val();
	   var store_id = $('input[name=store_id]').val();
	   var lang_id = $('input[name=lang_id]').val();
	   if(cityId.length == 0){
           layer.alert('请先选择地区', {
               icon: 2,
               btn: false,
               title: false,
               closeBtn: 0,
               time: 2000,
               skin: 'alt-layer'
           });
           return false;
	   }
        if(q.length == 0){
            layer.alert('请输入关键字', {
                icon: 2,
                btn: false,
                title: false,
                closeBtn: 0,
                time: 2000,
                skin: 'alt-layer'
            });
            return false;
        }
        $.ajax({
            url: 'index.php?app=design&act=getHuXing',
            type: 'post',
            data: {'cityId': cityId, 'q': q},
            async: false, //默认为true 异步
            error: function() {
                alert('error');
            },
            success: function(data) {
                var data = eval("(" + data + ")");
                var html ='';
                $.each(data,function(index,value){
				  html +='<li>'
					 + '<a href="?app=design&act=searchCreate&plan_id='+value.obsPlanId+"&hx="+value.specName+"&xq="+value.commName+"&imgUrl="+value.smallPics+"&city="+value.planCity+"&storeid="+store_id+"&lang="+lang_id+"&obsUserId="+value.obsUserId+'">'
					 + "<img src="+value.smallPics+' width="255" height="285">'
					 + '<p  class="ellipsis">'+value.planCity+'&nbsp;'+value.specName+'</p>'
					 + '<p  class="">'+value.commName+'</p>'
					 + '<span class="choose">选择</span>'
					 + '</li>'
					$('.resultlist').html(html);
				})
            }
        });

	});
</script>
	  {/literal}
</body>
</html>